<div class="column_scheduling">
    <h3>Operações | CONTRATOS</h3>

    <div class="flex-container">
        <div>
            <span>
               Total de contratos
            </span>
            <p>{{operacaoContrato.totalContratos}}</p>
        </div>
        <div>
            <span>
                Contratos vigentes
            </span>
            <p>{{operacaoContrato.contratosVigentes}}</p>
        </div>
        <div>
            <span>
                Saldo atual
            </span>
            <p>{{operacaoContrato.saldoAtual}}</p>
        </div>
        <div>
            <span>
                Receita compartilhada
            </span>
            <p>{{operacaoContrato.receitaCompartilhada}}</p>
        </div>
    </div>
</div>

<div class="container-main">
    
    <h1><i class="pi pi-angle-double-right" style="font-size: 1rem"></i> Histórico </h1>
    <h4>resumo das operações vigentes</h4>
</div>
<div class="charts container-main">

    <p-table [value]="listaContratos" dataKey="codigoContrato">

        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="contrato">Contrato</th>
                <th pSortableColumn="dataEmissao">Data emissão</th>
                <th pSortableColumn="valor">Valor</th>
                <th pSortableColumn="taxaJuros">Taxa de juros</th>
                <th pSortableColumn="tac">TAC</th>
                <th pSortableColumn="iof">IOF</th>
                <th pSortableColumn="revenueShare">Revenue share</th>
                <th pSortableColumn="saldoAberto">Saldo em aberto</th>
                <th style="width: 3rem"></th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-contrato let-expanded="expanded">
            <tr>
                <td>{{contrato.codigoContrato}}</td>
                <td>{{contrato.dataEmissao}}</td>
                <td>{{contrato.valor}}</td>
                <td>{{contrato.taxaJuros}}</td>
                <td>{{contrato.tac}}</td>
                <td>{{contrato.iof}}</td>
                <td>{{contrato.revenueShare}}</td>
                <td>{{contrato.saldoAberto}}</td>
                <td>
                    <button type="button" pButton pRipple [pRowToggler]="contrato" class="p-button-rounded"
                        [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-up'"></button>
                </td>
            </tr>
        </ng-template>

        <ng-template pTemplate="rowexpansion" let-contrato>
            <tr>
                <td colspan="9">
                    <div class="p-p-3">
                        <p-table [value]="contrato.detalhes" dataKey="codigoContrato">

                            <ng-template pTemplate="header">
            <tr>
                <th>Valor bruto financiamento</th>
                <th>Pagamentos realizados</th>
                <th>Juros quitados</th>
                <th>Amortizado</th>
                <th>Saldo principal em aberto</th>
                <th>Saldo de juros em aberto</th>
                <th></th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-detalhes>
            <tr>
                <td>{{detalhes.valorBrutoFinanciamento}}</td>
                <td>{{detalhes.pagamentosRealizado}}</td>
                <td>{{detalhes.jurosQuitados}}</td>
                <td>{{detalhes.amortizado}}</td>
                <td>{{detalhes.saldoPrincipalAberto}}</td>
                <td>{{detalhes.saldoJurosAberto}}</td>
                <td colspan="2">
                    <p-button (click)="showModalDialog()" type="button">Detalhamento dos pagamentos</p-button>
                </td>
                <td></td>
            </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="6">Não existe contratos</td>
            </tr>
        </ng-template>
    </p-table>

</div>
</td>
</tr>
</ng-template>
</p-table>
</div>

<p-dialog header="Previsão de pagamentos" [(visible)]="displayModal" [modal]="true" [style]="{width: '100%'}" [baseZIndex]="10000"
    [draggable]="false" [resizable]="true">
    <p-table [value]="listaPagamentos" dataKey="codigoPagamento">

        <ng-template pTemplate="header">
            <tr>        
                <th>Pagamento</th>
                <th>Tipo</th>
                <th>Data</th>
                <th>Valor</th>
                <th>Saldo em aberto</th>
                <th>Juros quitados</th>
                <th>Amortização realizada</th>
                <th>Saldo após o pagamento</th>            
                <th>Saldo de juros</th>            
                <th>Saldo principal</th>            
            </tr>
        </ng-template>
    
         <ng-template pTemplate="body" let-pagamento>
            <tr>
                <td>{{pagamento.pagamento}}</td>
                <td>{{pagamento.tipo}}</td>
                <td>{{pagamento.data}}</td>
                <td>{{pagamento.valor}}</td>
                <td>{{pagamento.saldoAberto}}</td>
                <td>{{pagamento.jurosQuitados}}</td>
                <td>{{pagamento.amortizacaoRealizada}}</td>
                <td>{{pagamento.saldoAposPagamento}}</td>
                <td>{{pagamento.saldoJurosAberto}}</td>
                <td>{{pagamento.saldoPrincipalAberto}}</td>
            </tr>
        </ng-template> 
    </p-table>
</p-dialog>